<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/UI/admin/layout/seller_layout}"
      >
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CampOn(ìº í”„ì˜¨)</title>
</head>
<body layout:fragment="content">
    <div class="container-sm">
        <div class="w-100 text-center my-3">
            <h5>ìº í•‘ì¥ ìˆ˜ì •</h5>
        </div>
        <form th:action="|/admin/campproductupdatePro?${_csrf.parameterName}=${_csrf.token}|" method="post" enctype="multipart/form-data">
            <!-- ğŸˆ multipart/form-data ì¸ ê²½ìš° csrf í† í°ì„ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë‹´ì•„ì•¼í•œë‹¤.  -->
            <!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" /> -->
            <input type="hidden" name="campNo" id="campNo" th:value="${camp.campNo}">
            <div class="form-floating my-2">
                <input type="text" id="campName" name="campName" class="form-control" th:value="${camp.campName}">
                <label for="campName">ìº í•‘ì¥ëª…</label>
            </div>
            <div class="form-floating">
                <input type="file" id="file" name="file" class="form-control" multiple>
                <label for="file">ìº í•‘ì¥ì´ë¯¸ì§€</label>
            </div>
            <div class="campadd_box d-flex justify-content-around w-100 my-1">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div class="form-floating my-2">
                <input type="text" id="campAddress" name="campAddress" class="form-control" th:value="${camp.campAddress}">
                <label for="campAddress">ìº í•‘ì¥ì£¼ì†Œ</label>
            </div>
            <div class="form-floating">
                <input type="text" id="placeName" name="placeName" class="form-control" th:value="${camp.campName}">
                <label for="placeName">ì¥ì†Œëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”</label>
            </div>
            <div class="form-floating my-2 d-flex">
                <input type="text" name="campLocation" id="campLocation" class="form-control">
                <label for="campLocation">ì§€ë„ê²€ìƒ‰ì„ ìœ„í•œ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</label>
                <button type="button" onclick="search()">ê²€ìƒ‰</button>
            </div>
            <input type="hidden" id="campLatitude" name="campLatitude" placeholder="ìœ„ë„(latitude)" th:value="${camp.campLatitude}">
            <input type="hidden" id="campLongitude" name="campLongitude" placeholder="ê²½ë„(longitude)" th:value="${camp.campLongitude}">
            <div id="map" style="width:100%;height:600px;">
                <!-- api ì§€ë„ ì¶œë ¥ ë¶€ë¶„ -->
            </div>
            <div class="form-floating my-2">
                <input type="text" id="campTel" name="campTel" class="form-control" th:value="${camp.campTel}">
                <label for="campTel">ìº í•‘ì¥ ì—°ë½ì²˜</label>
            </div>
            <div class="form-floating my-2">
                <input type="file" id="layoutFile" name="layoutFile" class="form-control" th:value="${camp.campLayout}">
                <label for="layoutFile">ìº í•‘ì¥ ë°°ì¹˜ë„</label>
            </div>
            <div class="form-floating my-2">
                <input type="text" id="campCaution" name="campCaution" class="form-control" th:value="${camp.campCaution}">
                <label for="campCaution">ë§¤ë„ˆíƒ€ì„</label>
            </div>
            <div class="w-100 my-2 d-flex justify-content-between">
                <div>
                    <span>ì§€ì—­</span>
                </div>
                <div>
                    <input type="radio" id="seoul" name="regionNo" value="1" th:attr="checked=${camp.regionNo == 1 ? 'ture' : 'false'}">
                    <label for="seoul"><span></span>ì„œìš¸</label>
                    <input type="radio" id="inchon" name="regionNo" value="2" th:attr="checked=${camp.regionNo == 2 ? 'ture' : 'false'}">
                    <label for="inchon"><span></span>ì¸ì²œ</label>
                    <input type="radio" id="gyunggi" name="regionNo" value="3" th:attr="checked=${camp.regionNo == 3 ? 'ture' : 'false'}">
                    <label for="gyunggi"><span></span>ê²½ê¸°ë„</label>
                    <input type="radio" id="gangwon" name="regionNo" value="4" th:attr="checked=${camp.regionNo == 4 ? 'ture' : 'false'}">
                    <label for="gangwon"><span></span>ê°•ì›ë„</label>
                    <input type="radio" id="junra" name="regionNo" value="5" th:attr="checked=${camp.regionNo == 5 ? 'ture' : 'false'}">
                    <label for="junra"><span></span>ì „ë¼ë„</label>
                    <input type="radio" id="choung" name="regionNo" value="6" th:attr="checked=${camp.regionNo == 6 ? 'ture' : 'false'}">
                    <label for="choung"><span></span>ì¶©ì²­ë„</label>
                    <input type="radio" id="gyung" name="regionNo" value="7" th:attr="checked=${camp.regionNo == 7 ? 'ture' : 'false'}">
                    <label for="gyung"><span></span>ê²½ìƒë„</label>
                    <input type="radio" id="jeju" name="regionNo" value="8" th:attr="checked=${camp.regionNo == 8 ? 'ture' : 'false'}">
                    <label for="jeju"><span></span>ì œì£¼ë„</label>
                </div>
            </div>
            <div class="w-100 my-2">
                <span>í™˜ê²½</span>
                <input type="radio" id="mountain" name="environmentTypeNo" value="1" th:attr="checked=${camp.environmentTypeNo == 1 ? 'ture' : 'false'}">
                <label for="mountain"><span></span>ì‚°</label>
                <input type="radio" id="ocean" name="environmentTypeNo" value="2" th:attr="checked=${camp.environmentTypeNo == 2 ? 'ture' : 'false'}">
                <label for="ocean"><span></span>ë°”ë‹¤</label>
                <input type="radio" id="Valley" name="environmentTypeNo" value="3" th:attr="checked=${camp.environmentTypeNo == 3 ? 'ture' : 'false'}">
                <label for="Valley"><span></span>ê³„ê³¡/ê°•/í˜¸ìˆ˜</label>
                <input type="radio" id="champaign" name="environmentTypeNo" value="4" th:attr="checked=${camp.environmentTypeNo == 4 ? 'ture' : 'false'}">
                <label for="champaign"><span></span>í‰ì•¼</label>
                <input type="radio" id="downtown" name="environmentTypeNo" value="5" th:attr="checked=${camp.environmentTypeNo == 5 ? 'ture' : 'false'}">
                <label for="downtown"><span></span>ë„ì‹¬</label>
            </div>
            <div class="w-100 my-2">
                <label for="facillity">ê¸°ë³¸ì‹œì„¤</label>
                <input type="checkbox" id="1" name="facilityTypeNo" value="1">
                <label for="1"><span></span>í™”ì¥ì‹¤</label>
                <input type="checkbox" id="2" name="facilityTypeNo" value="2">
                <label for="2"><span></span>ìƒ¤ì›Œì‹¤</label>
                <input type="checkbox" id="3" name="facilityTypeNo" value="3">
                <label for="3"><span></span>ê°œìˆ˜ëŒ€</label>
                <input type="checkbox" id="4" name="facilityTypeNo" value="4">
                <label for="4"><span></span>ë§¤ì •</label>
                <input type="checkbox" id="5" name="facilityTypeNo" value="5">
                <label for="5"><span></span>ë°”ë² íì¥</label>
                <input type="checkbox" id="6" name="facilityTypeNo" value="6">
                <label for="6"><span></span>ì „ê¸°ì°¨ì¶©ì „ì†Œ</label>
                <input type="checkbox" id="7" name="facilityTypeNo" value="7">
                <label for="7"><span></span>ì£¼ì°¨ì¥</label>
            </div>
            <div class="form-floating">
                <input type="date" class="form-control" id="campOpen" name="campOpen" th:value="${camp.campOpen}">
                <label for="campOpen">ì˜¤í”ˆë‚ ì§œ</label>
            </div>
            <div class="form-floating">
                <input type="date" class="form-control" id="campClose" name="campClose" th:value="${camp.campClose}">
                <label for="campClose">í´ë¡œì¦ˆë‚ ì§œ</label>
            </div>
            <div class="form-floating">
                <textarea name="campIntroduction" id="campIntroduction" class="form-control" th:text="${camp.campIntroduction}">

                </textarea>
                <label for="campIntroduction">ìº í•‘ì¥ ì†Œê°œ</label>
            </div>
            <div>
                <input type="submit" value="ìº í•‘ì¥ìˆ˜ì •" class="btn btn-warning btn-lg w-100 my-3 py-3">
            </div>
        </form>
    </div>

    <!-- <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=66c31d7d2fe00c73f61774f2c881769e&â€‹libraries=services"></script> -->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=4d9c4ccd55af22e749af292453ba1fa9&libraries=services"></script>
    <script>
    var mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div 
        mapOption = {
            center: new kakao.maps.LatLng(33.450701, 126.570667), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
            level: 3 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
        };  

    // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤    
    var map = new kakao.maps.Map(mapContainer, mapOption); 

    function search() {
        var placeName = document.getElementById('placeName').value
        var address = document.getElementById('campLocation').value

        if( placeName == '' )
            alert('ì¥ì†Œëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”')
        if( address == '' )
            alert('ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”')
        
        // ì£¼ì†Œ-ì¢Œí‘œ ë³€í™˜ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
        var geocoder = new kakao.maps.services.Geocoder();

        // ì£¼ì†Œë¡œ ì¢Œí‘œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
        geocoder.addressSearch(address, function(result, status) {

            // ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ì™„ë£Œëìœ¼ë©´ 
            if (status === kakao.maps.services.Status.OK) {
                let campLatitude = result[0].y
                let campLongitude = result[0].x

                console.log('ìœ„ë„(latitude) : ' + result[0].y);
                console.log('ê²½ë„(longitude) : ' + result[0].x);
                
                document.getElementById('campLatitude').value = campLatitude
                document.getElementById('campLongitude').value = campLongitude

                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                // ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¥¼ ë§ˆì»¤ë¡œ í‘œì‹œí•©ë‹ˆë‹¤
                var marker = new kakao.maps.Marker({
                    map: map,
                    position: coords
                });

                // ì¸í¬ìœˆë„ìš°ë¡œ ì¥ì†Œì— ëŒ€í•œ ì„¤ëª…ì„ í‘œì‹œí•©ë‹ˆë‹¤
                var infowindow = new kakao.maps.InfoWindow({
                    content: `<div style="width:150px;text-align:center;padding:6px 0;">${placeName}</div>`
                });
                infowindow.open(map, marker);

                // ì§€ë„ì˜ ì¤‘ì‹¬ì„ ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤
                map.setCenter(coords);
            } 
        });    

    }

    </script>
    <script th:inline="javascript">
        let facilityTypelist = [[${campfacility}]];
        
        for (let i = 0; i < facilityTypelist.length; i++) {
            let no = facilityTypelist[i].facilitytypeNo
            
            $('input:checkbox[name="facilityTypeNo"]').each(function() {
                if(this.value == no){
                    this.checked = true;
                }            
            });
        }
    </script>
</body>
</html>